This is copied from [joelnet](https://github.com/joelgrus/joelnet).